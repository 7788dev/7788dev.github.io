<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta property="og:description" content="傲骨心的博客"><meta property="og:type" content="website"><meta name="description" content="傲骨心的博客"><meta name="keyword" content="hexo,傲骨心,傲骨心的博客,技术开发,编程开发"><meta http-equiv="Cache-Control" content="max-age=31536000"><link rel="dns-prefetch" href="//cdn.bootcss.com"><link rel="dns-prefetch" href="//at.alicdn.com"><link rel="dns-prefetch" href="//busuanzi.ibruce.info"><link rel="dns-prefetch" href="//giscus.app"><link rel="shortcut icon" href="/img/favicon.ico"><title>路由协议优先级详解：常见的路由协议优先级 - Aoguxin Blog</title><link rel="stylesheet" href="/css/aircloud.css"><link rel="preload" href="/img/avatar.jpg" as="image"><link rel="stylesheet" href="/css/gitment.css"><link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css" media="print" onload="this.media='all'"<script></script><meta name="generator" content="Hexo 7.3.0"></head><body class="splash-active"><div class="site-nav-toggle" id="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><div class="index-about"><i>Form is emptiness, emptiness is form</i></div><div class="index-container"><div class="index-left"><div class="nav" id="nav"><div class="avatar-name"><div class="avatar"><img src="/img/avatar.jpg" loading="eager" decoding="sync"></div><div class="name"><i>Aoguxin</i></div></div><div class="contents" id="nav-content"><ul><li><a href="/"><i class="iconfont icon-shouye1"></i> <span>主页</span></a></li><li><a href="/tags"><i class="iconfont icon-biaoqian1"></i> <span>标签</span></a></li><li><a href="/archives"><i class="iconfont icon-guidang2"></i> <span>存档</span></a></li><li><a href="/collect/"><i class="iconfont icon-shoucang1"></i> <span>收藏</span></a></li><li><a href="/about/"><i class="iconfont icon-guanyu2"></i> <span>关于</span></a></li><li><a id="search"><i class="iconfont icon-sousuo1"></i> <span>搜索</span></a></li></ul></div><div id="toc" class="toc-article"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E7%AE%A1%E7%90%86%E8%B7%9D%E7%A6%BB%EF%BC%88AD%EF%BC%89%EF%BC%9F"><span class="toc-text">一、什么是管理距离（AD）？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AD%E4%B8%8EMetric%EF%BC%88%E5%BA%A6%E9%87%8F%E5%80%BC%EF%BC%89%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">AD与Metric（度量值）的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%B8%BB%E6%B5%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E9%BB%98%E8%AE%A4%E4%BC%98%E5%85%88%E7%BA%A7%EF%BC%88AD%E5%80%BC%EF%BC%89%E5%8F%82%E8%80%83"><span class="toc-text">二、主流路由协议默认优先级（AD值）参考</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%9E%E6%88%98%E5%9C%BA%E6%99%AF%EF%BC%9A%E8%B7%AF%E7%94%B1%E5%99%A8%E5%A6%82%E4%BD%95%E5%86%B3%E7%AD%96%EF%BC%9F"><span class="toc-text">三、实战场景：路由器如何决策？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E4%B8%8E%E6%80%BB%E7%BB%93"><span class="toc-text">四、注意事项与总结</span></a></li></ol></div></div><div class="search-field" id="search-field"><div class="search-bg" id="search-bg"></div><div class="search-container"><div class="search-input"><span id="esc-search"><i class="icon-fanhui iconfont"></i></span> <input id="search-input"> <span id="begin-search">搜索</span></div><div class="search-result-container" id="search-result-container"></div></div></div><div class="index-about-mobile"><i>Form is emptiness, emptiness is form</i></div></div><div class="index-middle"><div class="post-container"><div class="post-title">路由协议优先级详解：常见的路由协议优先级</div><div class="post-meta"><span class="attr">发布于：<span>2025-09-09 15:58:15</span></span> <span class="attr">标签：/ <a class="tag" href="/tags/#网络设备" title="网络设备">网络设备</a> <span>/</span> </span><span class="attr">访问：<span id="busuanzi_value_page_pv"></span></span></div><div class="post-content no-indent"><blockquote><p>在网络世界中，路由器常常会通过多种方式学到通往同一个目的地的多条路径。它如何做出选择？背后的关键机制就是路由协议优先级，也称为管理距离。</p></blockquote><p>当我们谈论网络路由时，一个核心问题是：<strong>当路由器从OSPF、RIP、BGP等多种协议中同时学到了通往同一个网络的路由时，它会相信谁？</strong></p><p>答案是：路由器不相信任何协议，它只相信一个叫做<strong>管理距离（Administrative Distance, AD）</strong> 的数字。这个数值是决定最佳路径的第一道，也是最重要的一道关卡。</p><h2 id="一、什么是管理距离（AD）？"><a href="#一、什么是管理距离（AD）？" class="headerlink" title="一、什么是管理距离（AD）？"></a>一、什么是管理距离（AD）？</h2><p><strong>管理距离（AD）</strong> 是一个0到255之间的整数值，用于衡量路由信息源的<strong>可信度</strong>。它可以理解为路由协议的“优先级”。</p><p><strong>记住一个黄金法则：AD值越小，优先级越高，路由越可信。</strong></p><p>当多条通往同一网络的路由出现在路由器中时，路由器会优先选择AD值最小的那条放入其路由表，而完全忽略AD值更大的路由，无论它们的度量值（Metric）看起来有多好。</p><h3 id="AD与Metric（度量值）的区别"><a href="#AD与Metric（度量值）的区别" class="headerlink" title="AD与Metric（度量值）的区别"></a>AD与Metric（度量值）的区别</h3><p>这是一个至关重要的概念区分：</p><ul><li><strong>管理距离（AD）</strong>：用于<strong>不同路由协议之间</strong>的比较。回答“哪个协议提供的信息更可信？”。</li><li><strong>度量值（Metric）</strong>：用于<strong>同一路由协议内部</strong>的比较。回答“在这个协议提供的多条路径里，哪条更好？”。<ul><li><em>例如：RIP使用跳数（Hops），OSPF使用成本（Cost，通常基于带宽），EIGRP使用复合度量（带宽、延迟等）。</em></li></ul></li></ul><p><strong>决策顺序：先比AD，再比Metric。</strong> 只有当AD值相同时，路由器才会去比较度量值。</p><h2 id="二、主流路由协议默认优先级（AD值）参考"><a href="#二、主流路由协议默认优先级（AD值）参考" class="headerlink" title="二、主流路由协议默认优先级（AD值）参考"></a>二、主流路由协议默认优先级（AD值）参考</h2><p>不同网络设备厂商（如Cisco、华为、H3C）赋予协议的默认AD值略有不同。下表以业界最常参考的<strong>思科（Cisco）标准</strong>为例，并附上华为设备的常见值作为对比。</p><table><thead><tr><th align="left">路由来源</th><th align="left">默认AD值 (Cisco)</th><th align="left">默认AD值 (华为)</th><th align="left">解释与可信度</th></tr></thead><tbody><tr><td align="left"><strong>直连接口 (Connected)</strong></td><td align="left"><strong>0</strong></td><td align="left"><strong>0</strong></td><td align="left"><strong>最高优先级</strong>。路由器自身接口直接所在网段，绝对可信。</td></tr><tr><td align="left"><strong>静态路由 (Static)</strong></td><td align="left"><strong>1</strong></td><td align="left"><strong>60</strong></td><td align="left">网络管理员手动配置，被视为非常可靠的信赖来源。</td></tr><tr><td align="left"><strong>EIGRP 汇总路由</strong></td><td align="left"><strong>5</strong></td><td align="left"><strong>5</strong></td><td align="left">由EIGRP自动生成的汇总路由，优先级较高。</td></tr><tr><td align="left"><strong>外部BGP (eBGP)</strong></td><td align="left"><strong>20</strong></td><td align="left"><strong>255</strong></td><td align="left"><strong>注意巨大差异</strong>：在思科中，从外部AS学到的BGP路由很可信；在华为中默认优先级最低。</td></tr><tr><td align="left"><strong>内部EIGRP</strong></td><td align="left"><strong>90</strong></td><td align="left"><strong>100</strong></td><td align="left">思科私有高级协议的内部路由。</td></tr><tr><td align="left"><strong>OSPF</strong></td><td align="left"><strong>110</strong></td><td align="left"><strong>150</strong></td><td align="left">应用最广泛的链路状态内部网关协议。</td></tr><tr><td align="left"><strong>IS-IS</strong></td><td align="left"><strong>115</strong></td><td align="left"><strong>15</strong></td><td align="left"><strong>另一个巨大差异</strong>：在华为&#x2F;H3C中IS-IS优先级极高（15），仅次于直连和静态路由。</td></tr><tr><td align="left"><strong>RIP</strong></td><td align="left"><strong>120</strong></td><td align="left"><strong>100</strong></td><td align="left">传统的距离矢量协议，可信度较低。</td></tr><tr><td align="left"><strong>外部EIGRP</strong></td><td align="left"><strong>170</strong></td><td align="left"><strong>170</strong></td><td align="left">从其他自主系统重分布进EIGRP的路由，可信度较低。</td></tr><tr><td align="left"><strong>内部BGP (iBGP)</strong></td><td align="left"><strong>200</strong></td><td align="left"><strong>255</strong></td><td align="left">在同一BGP自主系统内传递的路由。</td></tr><tr><td align="left"><strong>未知或不可信</strong></td><td align="left"><strong>255</strong></td><td align="left"><strong>255</strong></td><td align="left">255表示“完全不可信”，此类路由不会被加入路由表。</td></tr></tbody></table><h2 id="三、实战场景：路由器如何决策？"><a href="#三、实战场景：路由器如何决策？" class="headerlink" title="三、实战场景：路由器如何决策？"></a>三、实战场景：路由器如何决策？</h2><p>让我们通过一个例子来生动理解这个过程。</p><p>假设一台<strong>思科路由器</strong>通过三种方式学到了通往网络 <code>192.168.100.0/24</code> 的路由：</p><ol><li><strong>通过OSPF</strong>： 下一跳为 <code>10.1.1.1</code>，度量值 Cost &#x3D; 100。</li><li><strong>通过RIP</strong>： 下一跳为 <code>192.168.2.2</code>，度量值 Hop &#x3D; 2。</li><li><strong>静态路由</strong>： 由管理员配置，下一跳为 <code>172.16.1.1</code>。</li></ol><p><strong>路由器的决策过程如下：</strong></p><ol><li><strong>比较AD值</strong>：<ul><li>静态路由 AD &#x3D; <strong>1</strong></li><li>OSPF路由 AD &#x3D; <strong>110</strong></li><li>RIP路由 AD &#x3D; <strong>120</strong></li></ul></li><li><strong>做出选择</strong>：<ul><li>静态路由的AD值<strong>最小</strong>，因此它被判定为<strong>最可信</strong>的路径。</li><li>路由器会毫不犹豫地将这条静态路由加入其<strong>路由表</strong>，并丢弃OSPF和RIP提供的路由信息。</li></ul></li><li><strong>注意</strong>：<ul><li>在这个过程中，<strong>度量值（Cost&#x3D;100 vs Hop&#x3D;2）完全没有被比较</strong>。因为第一道关卡（AD）已经决出了胜负。</li></ul></li></ol><p><strong>如果静态路由被移除</strong>，那么OSPF（AD&#x3D;110）和RIP（AD&#x3D;120）之间，OSPF会因AD值更小而胜出。</p><h2 id="四、注意事项与总结"><a href="#四、注意事项与总结" class="headerlink" title="四、注意事项与总结"></a>四、注意事项与总结</h2><ol><li><strong>厂商差异</strong>：上表清晰表明，不同厂商的默认AD值可能大相径庭（如eBGP和IS-IS）。在进行多厂商设备混合组网时，必须仔细检查并可能手动调整AD值，以避免次优路径或路由环路问题。</li><li><strong>可手动调整</strong>：绝大多数网络操作系统都允许管理员手动修改特定路由协议的AD值。例如，你可以将OSPF的AD值从110改为95，使其比内部EIGRP（90）优先级低，但比RIP（120）高。这是一个非常强大的网络控制工具。</li><li><strong>255的含义</strong>：AD值255是一个特殊标记，路由器会直接忽略它，视其为无效路由。</li></ol><p><strong>总结一下</strong>：</p><p>理解和管理<strong>路由协议优先级（管理距离）</strong> 是网络工程师必备的核心技能。它是在复杂网络环境中控制流量路径、实现冗余备份和进行路由重分布的基础。记住：<strong>路由器总是优先选择最可信（AD值最小）的路径，信任优先于成本。</strong></p><br><div id="comment-container"></div><div id="disqus_thread"></div><div id="lv-container"></div><div class="giscus"></div></div></div></div></div><footer class="footer"><ul class="list-inline text-center"></ul><p><span>/</span> <span><a target="_blank" rel="noopener" href="https://778801.xyz">十年之约</a></span> <span>/</span> <span><a target="_blank" rel="noopener" href="https://www.bing.com/search?q=技术博客">搜一搜:技术博客</a></span> <span>/</span></p><p><span id="busuanzi_container_site_pv"><span id="busuanzi_value_site_pv"></span>PV </span><span id="busuanzi_container_site_uv"><span id="busuanzi_value_site_uv"></span>UV </span>Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p></footer></body><script>window.hexo_search_path="search.json",window.hexo_root="/",window.isPost=!0</script><script defer src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><script defer src="/js/index.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://giscus.app/client.js" data-repo="7788dev/blog" data-repo-id="R_kgDOPQa4Ig" data-category="Announcements" data-category-id="DIC_kwDOPQa4Is4CtQJQ" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script></html>